from . import Vulnerability, SoftwareForAnalyze
from .analyzers import OSV, NVD


class VulnerabilityAnalyzer:
    def __init__(self):
        self._osv = OSV()
        self._nvd = NVD()

    def analyze(self, software: SoftwareForAnalyze) -> list[Vulnerability]:
        vulnerabilities: list[Vulnerability] = self._osv.check_vulnerabilities(software)
        vulnerabilities.extend(self._nvd.check_vulnerabilities(software))

        return vulnerabilities